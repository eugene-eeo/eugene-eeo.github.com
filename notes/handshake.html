<!doctype html><meta charset=utf-8><style>body{font-family:Georgia,serif;font-size:16px;width:35em;margin:3em auto}code,pre{font-family:Inconsolata,Menlo,Consolas,monospace}li{margin:.5em 0}.has-jax{font:inherit;font-size:90%}h1,h2,h3{font-weight:400}hr{background-color:#000;border:0;height:1px}.footnotes{margin-top:5em;font-size:.75em}table{border-collapse:collapse}th{background-color:#EEE}td,th{border:1px solid #000;padding:.2em .5em}</style><title>Key Exchange (Handshake)</title><h1>Key Exchange (Handshake)</h1><p>Used in SSH and TLS. Maintains security against passive (eavesdropping) adversaries. The aim is to agree upon a shared key <code>$ k $</code> for encrypting and decrypting messages without sending it over the network.<ol><li>Two people, <strong>A</strong> and <strong>B</strong> want to communicate. Eavesdropper <strong>C</strong> wants to eavesdrop on the data sent.<li><strong>A</strong> and <strong>B</strong> choose two secrets <code>$ S_A $</code> and <code>$ S_B $</code>.<li>All participants know a commutative, associative and one-way operation <code>$ \circ $</code> and an initial value <code>$ \sigma $</code> (usually protocol-specific).<ul><li><strong>A</strong> sends <code>$ S_A \circ \sigma $</code> to <strong>B</strong>.<li><strong>B</strong> sends <code>$ S_B \circ \sigma $</code> to <strong>A</strong>.</ul><li>Now <strong>A</strong> and <strong>B</strong> mix in their own secrets:<ul><li><strong>A</strong> calculates <code>$ k = S_A \circ (S_B \circ \sigma) $</code><li><strong>B</strong> calculates <code>$ k = S_B \circ (S_A \circ \sigma) $</code></ul><li><strong>C</strong> only knows <code>$ \sigma $</code>, <code>$ S_A \circ \sigma $</code>, and <code>$ S_B \circ \sigma $</code> and there is no way to recover <code>$ S_A $</code> or <code>$ S_B $</code> from what he/she knows. Thus <strong>C</strong> cannot reconstruct <code>$ k $</code>, given a strong enough operation <code>$ \circ $</code>.</ol><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.js></script><script>!function(){function e(e){var t=e.match(a);return t?{TeX:t[1]||t[2],displayMode:!!t[1]}:null}for(var t=document.getElementsByTagName("code"),a=/(?:^\$\$\s*([\s\S]+)\s*\$\$$)|(?:^\$\s*([\s\S]+)\s*\$$)/,s=t.length;s--;){var n=t[s],r=e(n.textContent);r&&(katex.render(r.TeX,n,{displayMode:r.displayMode,throwOnError:!1}),n.classList.add("has-jax"))}}()</script>