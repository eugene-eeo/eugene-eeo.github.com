<!doctype html><meta charset=utf-8><style>body{font-family:Georgia,serif;font-size:16px;width:35em;margin:3em auto}code,pre{font-family:Inconsolata,Menlo,Consolas,monospace}li{margin:.5em 0}.has-jax{font:inherit;font-size:90%}h1,h2,h3{font-weight:400}hr{background-color:#000;border:0;height:1px}.footnotes{margin-top:5em;font-size:.75em}table{border-collapse:collapse}th{background-color:#EEE}td,th{border:1px solid #000;padding:.2em .5em}</style><title>Decomposing Sums of Powers</title><h1>Decomposing Sums of Powers</h1><p>Consider the following summation:<p><code>$$ S = u^0 + u^1 + u^4 + u^5 $$</code><p>More generally given a set of exponents <code>$ E $</code>, for instance in the previous example <code>$ E = \{ 0, 1, 4, 5 \} $</code> — we can write more rigorously:<p><code>$$ S = \sum_{i \in E}{u^i}, \, E \subseteq \mathbb{Z}^{+}_{0} $$</code><p><strong>Claim:</strong> there is one and only one unique <code>$ E $</code> given any sum <code>$ S $</code>.<p><strong>Proof:</strong> represent the sum in base-<code>$ u $</code>. See that to turn on the <code>$ i $</code>-th digit in such a representation, <code>$ E $</code> must contain <code>$ i-1 $</code>. Furthermore, every power of <code>$ u $</code>, <code>$ u^{i-1} $</code> will turn on the <code>$ i $</code>-th digit — and <em>only</em> the <code>$ i $</code>-th digit.<p><code>$$ D(S, k) = \begin{cases} \varnothing &amp; \text{if } S = 0, \\ \{ k \} \cup D(S-1, k) &amp; \text{if } S \bmod u = 1, \\ D(S/u, k+1) &amp; \text{otherwise.} \end{cases} $$</code><p><strong>Claim:</strong> <code>$ D(S, 0) $</code> correctly computes the set of exponents <code>$ E $</code>.<p><strong>Proof:</strong> By induction. Trivially, <code>$ D(0, 0) $</code> returns the null set, which is correct. Now consider the set <code>$ E = E' \cup \{ m \} $</code>, where <code>$ m = \min E $</code> and <code>$ E' = E - \{ m \} $</code> (every element in <code>$ E $</code> other than <code>$ m $</code>). We observe that:<p><code>$$ S = u^m + \sum_{i \in E'}{u^i} $$</code><p>After <code>$ m $</code> recursions, let the first argument to the <code>$ D $</code> function be <code>$ S' $</code> and we see that<p><code>$$ S' = 1 + \frac{1}{u^m} \sum_{i \in E'}{u^i} $$</code><p>So <code>$ S' $</code> will be odd and <code>$ m $</code> will be added to the result set. In the next recursion notice that<p><code>$$ S' = \frac{1}{u^m} \sum_{i \in E'}{u^i} = \sum_{i \in E'}{u^{i-m}} $$</code><p>which must be even because every element in <code>$ E' $</code> is larger than <code>$ m $</code>. If <code>$ S' = 0 $</code> then the remaining set of exponents is empty, and the algorithm terminates. The full <code>$ E $</code> is recovered. The algorithm must terminate because <code>$ S' = S/u $</code> or <code>$ S-1 $</code> on each recursion.<h2>Notes</h2><p>The direct translation of the function to pseudo-code is given below, with a runtime of <code>$ O(|E| + \max E) $</code> since for every element in <code>$ E $</code> we need to perform one extra operation in <code>$ O(1) $</code> time.<pre><code>Decompose(S, k, u)
   if S = 0:
      return ø
   if S % u == 1:
      return {k} ⋃ Decompose(S-1, k, u)
   return Decompose(S / u, k+1, u)
</code></pre><p>A looser bouned is <code>$ O(\max E) $</code>, since the maximal element is <code>$ \geq |E| $</code> (with the exception of <code>$ E = \{ 0 \} $</code>). An iterative version (in Python) with the same runtime:<pre><code>def decompose(S, u):
    k = 0
    E = []
    while S != 0:
        if S % u == 1:
            E.append(k)
            S -= 1
        S //= u
        k += 1
    return E
</code></pre><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.8.3/katex.min.js></script><script>!function(){function e(e){var t=e.match(a);return t?{TeX:t[1]||t[2],displayMode:!!t[1]}:null}for(var t=document.getElementsByTagName("code"),a=/(?:^\$\$\s*([\s\S]+)\s*\$\$$)|(?:^\$\s*([\s\S]+)\s*\$$)/,s=t.length;s--;){var n=t[s],r=e(n.textContent);r&&(katex.render(r.TeX,n,{displayMode:r.displayMode,throwOnError:!1}),n.classList.add("has-jax"))}}()</script>